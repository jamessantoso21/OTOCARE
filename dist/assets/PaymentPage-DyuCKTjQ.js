import{j as e,a as C,d as N}from"./index-7S1YI_WY.js";import{e as R,r as c,b as E}from"./vendor-react-D2XI2PP0.js";import{N as I,F as T}from"./Footer-BkaXL5t4.js";import{R as O}from"./RepairShopBanner-CMkoPsas.js";import{f as U,h as u,q as f,w as x,j as P}from"./vendor-firebase-CAApZDyK.js";/* empty css                       */function k(){return e.jsx("div",{className:"PaymentHeader-container",children:e.jsx("div",{className:"PaymentHeader-wrapper",children:e.jsx("h1",{children:"INVOICE"})})})}function Q(){const{searchID:l}=R(),[j,D]=c.useState([]),g=E(),[n,S]=c.useState(null);c.useEffect(()=>{const s=C.onAuthStateChanged(t=>{S(t)});return()=>s()},[]);const M=({color:s})=>e.jsx("hr",{style:{color:s,backgroundColor:s,height:2,width:"100%"}}),d=async s=>{if(!n){alert("Please login to continue with payment"),g("/login");return}console.log("Current User in Payment:",n),console.log("Current User UID:",n.uid);try{const t={orderShop:a.title,orderList:m.map(i=>({id:i.id,serviceTitle:i.serviceTitle,servicePrice:i.servicePrice})),orderPrice:v+1e4,orderPaymentMethod:s,orderDate:new Date,userUID:n.uid};console.log("Order Data being sent:",t);const h=await U(u(N,"Orders"),t);console.log("Order placed successfully with ID: ",h.id),g("/confirmation")}catch(t){console.error("Error placing order: ",t)}};c.useEffect(()=>{window.scrollTo(0,0)},[]),c.useEffect(()=>{(async()=>{try{const t=f(u(N,"RepairShops"),x("title",">=",l),x("title","<=",l+"ï£¿")),h=await P(t);let i=[];for(const p of h.docs){const r=p.data(),w=await P(f(u(p.ref,"Services"),x("choice","==",!0)));let y=[];for(const b of w.docs){const o=b.data();y.push({id:b.id,serviceTitle:o.title,servicePrice:o.price,priceText:o.subtitle,choice:o.choice})}i.push({id:p.id,img:r.img,rating:r.rating,service1:r.service1,service2:r.service2,service3:r.service3,star:r.star,subtitle:r.subtitle,title:r.title,services:y})}D(i)}catch(t){console.log("No data fetched, Error found :",t)}})()},[l]);const a=j.length>0?j[0]:null,m=a?a.services:[],v=m.reduce((s,t)=>s+t.servicePrice,0);return e.jsxs(e.Fragment,{children:[e.jsx("div",{children:e.jsx(I,{})}),a&&e.jsx(O,{title:a.title,rating:a.rating}),e.jsx(k,{}),e.jsx("div",{className:"PaymentDetails-container",children:e.jsx("div",{className:"PaymentDetails-wrapper",children:e.jsxs("div",{className:"PaymentDetails-margin",children:[e.jsxs("div",{className:"PaymentDetails-wrapper-middle",children:[m.map(s=>e.jsxs("div",{className:"ServicePayment",children:[e.jsx("p",{children:s.serviceTitle}),e.jsxs("p",{children:["Rp ",s.servicePrice]})]},s.id)),e.jsxs("div",{className:"MobileServiceCharge",children:[e.jsx("p",{children:"MOBILE SERVICE CHARGE"}),e.jsx("p",{children:"Rp 10000"})]}),e.jsx(M,{color:"black"}),e.jsxs("div",{className:"Subtotal",children:[e.jsx("p",{children:"SUBTOTAL"}),e.jsxs("p",{children:["Rp ",v+1e4]})]})]}),e.jsx("div",{className:"PaymentMethod",children:e.jsx("h1",{children:"PAYMENT METHOD"})}),e.jsxs("div",{className:"PaymentDetails-wrapper-bottom",children:[e.jsxs("button",{className:"paymentMethod-btn",onClick:()=>d("Pay at Merchant"),children:[e.jsx("div",{className:"paymentMethod-btn-text",children:"Pay at Merchant"}),e.jsx("img",{src:"/Merchant.png",alt:"",className:"paymentMethod-img"})]}),e.jsxs("button",{className:"paymentMethod-btn",onClick:()=>d("QRIS"),children:[e.jsx("div",{className:"paymentMethod-btn-text",children:"QRIS"}),e.jsx("img",{src:"/qr.png",alt:"",className:"paymentMethod-img"})]}),e.jsxs("button",{className:"paymentMethod-btn",onClick:()=>d("Debit/Credit"),children:[e.jsx("div",{className:"paymentMethod-btn-text",children:"Debit/Credit"}),e.jsxs("div",{className:"debit-container",children:[e.jsx("img",{src:"/visa.png",alt:"",className:"debit-img"}),e.jsx("img",{src:"/mastercard.png",alt:"",className:"debit-img"}),e.jsx("img",{src:"/amex.png",alt:"",className:"debit-img"})]})]})]})]})})}),e.jsx(T,{})]})}export{Q as default};
